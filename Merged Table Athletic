let
    Source = Excel.Workbook(File.Contents("C:\Users\marce\OneDrive\Documents\Dissertation\Data\Data Collection.xlsm"), null, true),
    #"Data - Progression_Sheet" = Source{[Item="Data - Progression",Kind="Sheet"]}[Data],
    #"Promoted Headers" = Table.PromoteHeaders(#"Data - Progression_Sheet", [PromoteAllScalars=true]),
    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"Block", Int64.Type}, {"ID", type text}, {"Forename(s)", type text}, {"Surname", type text}, {"Date of Birth", type date}, {"Age Group", type text}, {"Position", type text}, {"Football Skill 1", type text}, {"Football Development", type text}, {"Football Rating", Int64.Type}, {"Comment", Int64.Type}, {"Football Skill 2", type text}, {"Football Development_1", type text}, {"Football Rating_2", Int64.Type}, {"Comment_3", Int64.Type}, {"Non-Football Skill 1", type text}, {"Athletic Development", type text}, {"Athletic Rating", Int64.Type}, {"Comment_4", Int64.Type}, {"Non-Football Skill 2", type text}, {"Psychological Development", type text}, {"Psychological Rating", Int64.Type}, {"Comment_5", Int64.Type}, {"Helper1", type text}, {"Helper2", type text}, {"Helper3", type text}, {"Helper4", type text}}),
    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type",{"Block", "ID", "Forename(s)", "Surname", "Date of Birth", "Age Group", "Position", "Football Skill 1", "Football Development", "Football Rating", "Football Skill 2", "Football Development_1", "Football Rating_2", "Non-Football Skill 1", "Athletic Development", "Athletic Rating", "Non-Football Skill 2", "Psychological Development", "Psychological Rating"}),
    #"Renamed Columns" = Table.RenameColumns(#"Removed Other Columns",{{"Football Development", "Technical Development Skill"}, {"Football Rating", "Technical Development Rating"}, {"Football Development_1", "Tactical Development Skill"}, {"Football Rating_2", "Tactical Development Rating"}, {"Athletic Development", "Athletic Development Skill"}, {"Athletic Rating", "Athletic Development Rating"}, {"Psychological Development", "Psychological Development Skill"}, {"Psychological Rating", "Psychological Development Rating"}}),
    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"Football Skill 1", "Football Skill 2", "Non-Football Skill 1", "Non-Football Skill 2"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Removed Columns",{{"Block", Int64.Type}}),
    #"Removed Bottom Rows" = Table.RemoveLastN(#"Changed Type1",1),
    #"Merged Queries" = Table.NestedJoin(#"Removed Bottom Rows", {"ID"}, #"Duplicate Data - Base", {"ID"}, "Duplicate Data - Base", JoinKind.Inner),
    #"Expanded Duplicate Data - Base" = Table.ExpandTableColumn(#"Merged Queries", "Duplicate Data - Base", {"Technical Attribute", "Technical Base Rating", "Tactical Attribute", "Tactical Base Rating", "Athletic Attribute", "Athletic Base Rating", "Psychological Attribute", "Psychological Base Rating"}, {"Duplicate Data - Base.Technical Attribute", "Duplicate Data - Base.Technical Base Rating", "Duplicate Data - Base.Tactical Attribute", "Duplicate Data - Base.Tactical Base Rating", "Duplicate Data - Base.Athletic Attribute", "Duplicate Data - Base.Athletic Base Rating", "Duplicate Data - Base.Psychological Attribute", "Duplicate Data - Base.Psychological Base Rating"}),
    #"Renamed Columns1" = Table.RenameColumns(#"Expanded Duplicate Data - Base",{{"Duplicate Data - Base.Technical Attribute", "Technical Base Attribute"}, {"Duplicate Data - Base.Technical Base Rating", "Technical Base Rating"}, {"Duplicate Data - Base.Tactical Attribute", "Tactical Base Attribute"}, {"Duplicate Data - Base.Tactical Base Rating", "Tactical Base Rating"}, {"Duplicate Data - Base.Athletic Attribute", "Athletic Base Attribute"}, {"Duplicate Data - Base.Athletic Base Rating", "Athletic Base Rating"}, {"Duplicate Data - Base.Psychological Attribute", "Psychological Base Attribute"}, {"Duplicate Data - Base.Psychological Base Rating", "Psychological Base Rating"}}),
    #"Grouped Rows" = Table.Group(#"Renamed Columns1", {"ID", "Athletic Development Skill", "Athletic Base Attribute"}, {{"Max Base Athletic", each List.Max([Athletic Base Rating]), type number}, {"Max Development Athletic", each List.Max([Athletic Development Rating]), type nullable number}})
in
    #"Grouped Rows"
